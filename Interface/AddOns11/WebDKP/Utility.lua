function WebDKP_GetTableid()local a=WebDKP_Frame.selectedTableid;if a==nil then a=1 end;return a end;function WebDKP_PlayerInGroup(name)for b,c in pairs(WebDKP_PlayersInGroup)do if type(c)=="table"then if c["name"]==name then return true end end end;return false end;function WebDKP_GetGuildName(d)local e=GetNumGroupMembers()local name,f;for g=1,e do name,_,_,_,_,_,_,_,_=GetRaidRosterInfo(g)if name==d then guild,_,_=GetGuildInfo("raid"..g)return guild end end;local h=GetNumSubgroupMembers()for g=1,h do playerHandle="party"..g;name=UnitName(playerHandle)if name==d then guild,_,_=GetGuildInfo("raid"..g)return guild end end;if d==UnitName("player")then guild,_,_=GetGuildInfo("player")return guild end;return"Unknown"end;function WebDKP_GetFirstSelectedPlayer()for i,j in pairs(WebDKP_DkpTable)do if type(j)=="table"then if j["Selected"]then name=i;return name end end end;return"NONE"end;function WebDKP_GetTableSize(k)local l=0;if k==nil then return l end;for b,c in pairs(k)do l=l+1 end;return l end;function WebDKP_Print(m)DEFAULT_CHAT_FRAME:AddMessage(m,1,1,0)end;function WebDKP_GetItemInfo(n)local o,p,q,r,s,t,u,v,w,x=GetItemInfo(n)if q and o and p then return q,o,p,r,w else return 0,n,n end end;function WebDKP_ShouldIgnoreItem(o)for b,value in pairs(WebDKP_IgnoreItems)do if o==value then return true end end;return false end;function WebDKP_SelectPlayerOnly(y)for i,j in pairs(WebDKP_DkpTable)do if type(j)=="table"then local d=i;if d==y then WebDKP_DkpTable[d]["Selected"]=true else WebDKP_DkpTable[d]["Selected"]=false end end end;if WebDKP_PlayerIsShown(y)then WebDKP_ShowPlayer(y)end;WebDKP_UpdateTable()end;function WebDKP_PlayerIsShown(d)for i,j in pairs(WebDKP_DkpTableToShow)do if type(j)=="table"then if j.playerName==d then return true end end end;return false end;function WebDKP_ShowPlayer(d)if WebDKP_DkpTable[d]==nil then return end;local a=WebDKP_GetTableid()local z=WebDKP_DkpTable[d]["class"]local A=WebDKP_DkpTable[d]["dkp_"..a]if A==nil then A=0 end;local B=floor((A-1)/WebDKP_TierInterval)if A==0 then B=0 end;tinsert(WebDKP_DkpTableToShow,{playerName=d,playerClass=z,playerDkp=A,playerTier=B})end;function WebDKP_ROUND(C,D)return tonumber(string.format("%."..D.."f",C))end;function WebDKP_PlayerHasDKP(d)local E,a;if WebDKP_Tables~=nil and next(WebDKP_Tables)~=nil then for b,c in pairs(WebDKP_Tables)do if type(c)=="table"then a=c["id"]E=WebDKP_GetDKP(d,a)if E~=0 then return true end end end else E=WebDKP_GetDKP(d)if E~=0 then return true end end;return false end;function WebDKP_GetDKP(d,a,F,f)if d==nil then return 0,0 end;if a==nil then a=WebDKP_GetTableid()end;local G;local H;if WebDKP_Alts[d]~=nil and WebDKP_WebOptions["CombineAlts"]==1 then H=d;G=WebDKP_Alts[d]if F~=nil then WebDKP_MakeSureInTable(H,a,f)WebDKP_MakeSureInTable(G,a)end else G=d;if F~=nil then WebDKP_MakeSureInTable(G,a,f)end end;local I,J;if WebDKP_DkpTable[G]==nil then I=0;J=0 elseif WebDKP_DkpTable[G]["dkp_"..a]==nil then I=0;J=0 else I=WebDKP_DkpTable[G]["dkp_"..a]J=WebDKP_DkpTable[G]["dkp_lifetime_"..a]end;return I,J end;function WebDKP_MakeSureInTable(d,a,f,E)if d==nil then return end;if E==nil then E=0 end;if WebDKP_DkpTable[d]==nil then if f==nil then f="Unknown"end;WebDKP_DkpTable[d]={["dkp_"..a]=E,["class"]=f,["cantrim"]=true}end;if WebDKP_DkpTable[d]["dkp_"..a]==nil then WebDKP_DkpTable[d]["dkp_"..a]=0 end end;function WebDKP_GetMain(d,K)local G;if WebDKP_Alts[d]~=nil then G=WebDKP_Alts[d]if K~=nil and WebDKP_WebOptions["CombineAlts"]==0 then G=d end else G=d end;return G end;function WebDKP_GetPlayerClass(d)local z=WebDKP_DkpTable[d]["class"]if WebDKP_DkpTable[d]==nil then z="Druid"end;return z end;function WebDKP_GetCmd(L)if L then local M,N,O=strfind(L,"(%S+)")if M then return O,strsub(L,N+2)else return""end end end;function WebDKP_GetCommaCmd(L)if L then local M=strfind(L,",")if M then local P=strtrim(strsub(L,0,M-1))local Q=strtrim(strsub(L,M+1))return P,Q else return L end end end;function WebDKP_SendWhisper(R,S)SendChatMessage("WebDKP: "..S,"WHISPER",nil,R)end;function WebDKP_GetLootTableCost(T)local U=nil;local V,o,T,r,w=WebDKP_GetItemInfo(T)local value=WebDKP_GetItemID(T)if WebDKP_Loot~=nil then U=WebDKP_Loot[o]if WebDKP_Loot[o]==nil then U=WebDKP_Loot[value]end end;if U==nil or U==""then r=tostring(r)U=WebDKP_Loot[r]end;if U==nil or U==""then U=nil end;return U end;function WebDKP_GetItemID(T)local U=nil;if T~=nil and T~=""then local W="%|(.+)%|(%a+):(%d+):(.+)"_,_,hexvalue,itemtype,value,holder,_,test2=string.find(T,W)end;if value~=""and value~=nil then U=value end;return U end;function WebDKP_GetOptionValue(X,Y)local value;if WebDKP_Options[X]~=nil then value=WebDKP_Options[X]elseif WebDKP_WebOptions[X]~=nil then value=WebDKP_WebOptions[X]else value=Y;WebDKP_Options[X]=Y end;return value end
